{"ast":null,"code":"import { HttpClient } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/common\";\n\nfunction AddProductComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵtext(1, \" Le nom est obligatoire. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AddProductComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵtext(1, \" Prix en d\\u00E9tails invalide. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AddProductComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵtext(1, \" Prix grossiste invalide. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AddProductComponent_div_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵtext(1, \" Quantit\\u00E9 en stock invalide. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AddProductComponent_div_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵtext(1, \" Fichier image invalide (seuls jpg et png sont accept\\u00E9s). \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AddProductComponent_div_45_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"img\", 26);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", ctx_r10.product.imageurl, i0.ɵɵsanitizeUrl);\n  }\n}\n\nexport let AddProductComponent = /*#__PURE__*/(() => {\n  class AddProductComponent {\n    constructor(http) {\n      this.http = http;\n      this.product = {\n        name: '',\n        price: null,\n        price2: null,\n        available: true,\n        qtt_stock: null,\n        imageurl: ''\n      };\n      this.imageFileInvalid = false;\n      this.selectedFile = null;\n    }\n\n    onFileChange(event) {\n      const file = event.target.files[0];\n\n      if (file) {\n        const validTypes = ['image/jpeg', 'image/png', 'image/jpg'];\n\n        if (!validTypes.includes(file.type)) {\n          this.imageFileInvalid = true;\n          this.selectedFile = null;\n        } else {\n          this.imageFileInvalid = false;\n          this.selectedFile = file;\n          const reader = new FileReader();\n\n          reader.onload = () => {\n            this.product.imageurl = reader.result;\n          };\n\n          reader.readAsDataURL(file);\n        }\n      } else {\n        this.imageFileInvalid = false;\n        this.selectedFile = null;\n        this.product.imageurl = '';\n      }\n    }\n\n    submit() {\n      if (!this.product.name || this.product.price === null || this.product.price2 === null || this.product.qtt_stock === null || this.imageFileInvalid) {\n        alert('Veuillez remplir tous les champs correctement.');\n        return;\n      } // Préparer les données dans un FormData pour gérer fichier + données\n\n\n      const formData = new FormData();\n      formData.append('name', this.product.name);\n      formData.append('price', this.product.price.toString());\n      formData.append('price2', this.product.price2.toString());\n      formData.append('available', this.product.available.toString());\n      formData.append('qtt_stock', this.product.qtt_stock.toString());\n\n      if (this.selectedFile) {\n        formData.append('image', this.selectedFile, this.selectedFile.name);\n      } // Exemple d’URL, à changer par celle de ton API réelle\n\n\n      const apiUrl = 'admin/add-product'; // Envoyer la requête POST\n\n      this.http.post(apiUrl, formData).subscribe({\n        next: response => {\n          console.log('Produit ajouté avec succès', response);\n          alert('Produit ajouté avec succès'); // Réinitialiser le formulaire\n\n          this.product = {\n            name: '',\n            price: null,\n            price2: null,\n            available: true,\n            qtt_stock: null,\n            imageurl: ''\n          };\n          this.imageFileInvalid = false;\n          this.selectedFile = null;\n        },\n        error: err => {\n          console.error('Erreur lors de l\\'ajout', err);\n          alert('Erreur lors de l\\'ajout du produit');\n        }\n      });\n    }\n\n  }\n\n  AddProductComponent.ɵfac = function AddProductComponent_Factory(t) {\n    return new (t || AddProductComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n  };\n\n  AddProductComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddProductComponent,\n    selectors: [[\"app-add-product\"]],\n    decls: 48,\n    vars: 14,\n    consts: [[1, \"add-product-container\"], [\"routerLink\", \"/produits\", 1, \"back-btn\"], [1, \"fas\", \"fa-arrow-left\"], [1, \"product-form\", 3, \"ngSubmit\"], [\"productForm\", \"ngForm\"], [\"for\", \"name\"], [\"type\", \"text\", \"id\", \"name\", \"name\", \"name\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"ngModel\"], [\"class\", \"error-message\", 4, \"ngIf\"], [\"for\", \"price\"], [\"type\", \"number\", \"id\", \"price\", \"name\", \"price\", \"required\", \"\", \"min\", \"0\", \"step\", \"0.01\", 3, \"ngModel\", \"ngModelChange\"], [\"price\", \"ngModel\"], [\"for\", \"price2\"], [\"type\", \"number\", \"id\", \"price2\", \"name\", \"price2\", \"required\", \"\", \"min\", \"0\", \"step\", \"0.01\", 3, \"ngModel\", \"ngModelChange\"], [\"price2\", \"ngModel\"], [\"for\", \"available\"], [\"id\", \"available\", \"name\", \"available\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [3, \"ngValue\"], [\"for\", \"qtt_stock\"], [\"type\", \"number\", \"id\", \"qtt_stock\", \"name\", \"qtt_stock\", \"required\", \"\", \"min\", \"0\", 3, \"ngModel\", \"ngModelChange\"], [\"qtt_stock\", \"ngModel\"], [\"for\", \"imagefile\"], [\"type\", \"file\", \"id\", \"imagefile\", \"name\", \"imagefile\", \"accept\", \"image/png, image/jpeg\", \"required\", \"\", 3, \"change\"], [4, \"ngIf\"], [\"type\", \"submit\", 3, \"disabled\"], [1, \"error-message\"], [\"alt\", \"Pr\\u00E9visualisation\", 3, \"src\"]],\n    template: function AddProductComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"a\", 1);\n        i0.ɵɵelement(2, \"i\", 2);\n        i0.ɵɵtext(3, \" Retour \\u00E0 la liste des produits \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"h2\");\n        i0.ɵɵtext(5, \"Ajouter un produit\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"form\", 3, 4);\n        i0.ɵɵlistener(\"ngSubmit\", function AddProductComponent_Template_form_ngSubmit_6_listener() {\n          return ctx.submit();\n        });\n        i0.ɵɵelementStart(8, \"div\");\n        i0.ɵɵelementStart(9, \"label\", 5);\n        i0.ɵɵtext(10, \"Nom :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"input\", 6, 7);\n        i0.ɵɵlistener(\"ngModelChange\", function AddProductComponent_Template_input_ngModelChange_11_listener($event) {\n          return ctx.product.name = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(13, AddProductComponent_div_13_Template, 2, 0, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"div\");\n        i0.ɵɵelementStart(15, \"label\", 9);\n        i0.ɵɵtext(16, \"Prix en d\\u00E9tails :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"input\", 10, 11);\n        i0.ɵɵlistener(\"ngModelChange\", function AddProductComponent_Template_input_ngModelChange_17_listener($event) {\n          return ctx.product.price = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(19, AddProductComponent_div_19_Template, 2, 0, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\");\n        i0.ɵɵelementStart(21, \"label\", 12);\n        i0.ɵɵtext(22, \"Prix grossiste :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"input\", 13, 14);\n        i0.ɵɵlistener(\"ngModelChange\", function AddProductComponent_Template_input_ngModelChange_23_listener($event) {\n          return ctx.product.price2 = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(25, AddProductComponent_div_25_Template, 2, 0, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"div\");\n        i0.ɵɵelementStart(27, \"label\", 15);\n        i0.ɵɵtext(28, \"Disponible :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"select\", 16);\n        i0.ɵɵlistener(\"ngModelChange\", function AddProductComponent_Template_select_ngModelChange_29_listener($event) {\n          return ctx.product.available = $event;\n        });\n        i0.ɵɵelementStart(30, \"option\", 17);\n        i0.ɵɵtext(31, \"Oui\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"option\", 17);\n        i0.ɵɵtext(33, \"Non\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"div\");\n        i0.ɵɵelementStart(35, \"label\", 18);\n        i0.ɵɵtext(36, \"Quantit\\u00E9 en stock :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"input\", 19, 20);\n        i0.ɵɵlistener(\"ngModelChange\", function AddProductComponent_Template_input_ngModelChange_37_listener($event) {\n          return ctx.product.qtt_stock = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(39, AddProductComponent_div_39_Template, 2, 0, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"div\");\n        i0.ɵɵelementStart(41, \"label\", 21);\n        i0.ɵɵtext(42, \"Image du produit :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(43, \"input\", 22);\n        i0.ɵɵlistener(\"change\", function AddProductComponent_Template_input_change_43_listener($event) {\n          return ctx.onFileChange($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(44, AddProductComponent_div_44_Template, 2, 0, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(45, AddProductComponent_div_45_Template, 2, 1, \"div\", 23);\n        i0.ɵɵelementStart(46, \"button\", 24);\n        i0.ɵɵtext(47, \"Ajouter\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(7);\n\n        const _r1 = i0.ɵɵreference(12);\n\n        const _r3 = i0.ɵɵreference(18);\n\n        const _r5 = i0.ɵɵreference(24);\n\n        const _r7 = i0.ɵɵreference(38);\n\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngModel\", ctx.product.name);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", _r1.invalid && _r1.touched);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.product.price);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", _r3.invalid && _r3.touched);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.product.price2);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", _r5.invalid && _r5.touched);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.product.available);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngValue\", true);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngValue\", false);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.product.qtt_stock);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", _r7.invalid && _r7.touched);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.imageFileInvalid);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.product.imageurl);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"disabled\", _r0.invalid || ctx.imageFileInvalid);\n      }\n    },\n    directives: [i2.RouterLinkWithHref, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.NgForm, i3.DefaultValueAccessor, i3.RequiredValidator, i3.NgControlStatus, i3.NgModel, i4.NgIf, i3.MinValidator, i3.NumberValueAccessor, i3.SelectControlValueAccessor, i3.NgSelectOption, i3.ɵNgSelectMultipleOption],\n    styles: [\".add-product-container[_ngcontent-%COMP%] {\\n      max-width: 500px;\\n      margin: 20px auto;\\n      padding: 20px;\\n      border: 1px solid #ccc;\\n      border-radius: 8px;\\n      background-color: #fafafa;\\n      box-shadow: 0 2px 5px rgba(0,0,0,0.1);\\n      font-family: Arial, sans-serif;\\n    }\\n    .back-btn[_ngcontent-%COMP%] {\\n      display: block;\\n      margin-bottom: 20px;\\n      color: #007bff;\\n      text-decoration: none;\\n      font-size: 1rem;\\n      transition: color 0.3s ease;\\n    }\\n    .back-btn[_ngcontent-%COMP%]:hover {\\n      color: #0056b3;\\n    }\\n    .back-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] {\\n      margin-right: 5px;\\n    }\\n    .add-product-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n      text-align: center;\\n      margin-bottom: 20px;\\n      color: #333;\\n    }\\n    .product-form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] {\\n      margin-bottom: 15px;\\n      display: flex;\\n      flex-direction: column;\\n    }\\n    .product-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\\n      font-weight: 600;\\n      margin-bottom: 6px;\\n      color: #444;\\n    }\\n    .product-form[_ngcontent-%COMP%]   input[type=\\\"text\\\"][_ngcontent-%COMP%], .product-form[_ngcontent-%COMP%]   input[type=\\\"number\\\"][_ngcontent-%COMP%], .product-form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .product-form[_ngcontent-%COMP%]   input[type=\\\"file\\\"][_ngcontent-%COMP%] {\\n      padding: 8px 12px;\\n      font-size: 1rem;\\n      border: 1px solid #aaa;\\n      border-radius: 4px;\\n      outline: none;\\n      transition: border-color 0.3s ease;\\n    }\\n    .product-form[_ngcontent-%COMP%]   input[type=\\\"text\\\"][_ngcontent-%COMP%]:focus, .product-form[_ngcontent-%COMP%]   input[type=\\\"number\\\"][_ngcontent-%COMP%]:focus, .product-form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .product-form[_ngcontent-%COMP%]   input[type=\\\"file\\\"][_ngcontent-%COMP%]:focus {\\n      border-color: #007bff;\\n    }\\n    .error-message[_ngcontent-%COMP%] {\\n      color: #d9534f;\\n      font-size: 0.9rem;\\n      margin-top: 4px;\\n    }\\n    button[type=\\\"submit\\\"][_ngcontent-%COMP%] {\\n      width: 100%;\\n      padding: 10px 15px;\\n      font-size: 1.1rem;\\n      background-color: #007bff;\\n      border: none;\\n      border-radius: 5px;\\n      color: white;\\n      cursor: pointer;\\n      transition: background-color 0.3s ease;\\n    }\\n    button[type=\\\"submit\\\"][_ngcontent-%COMP%]:disabled {\\n      background-color: #aaa;\\n      cursor: not-allowed;\\n    }\\n    button[type=\\\"submit\\\"][_ngcontent-%COMP%]:not(:disabled):hover {\\n      background-color: #0056b3;\\n    }\\n    img[_ngcontent-%COMP%] {\\n      max-width: 100%;\\n      max-height: 250px;\\n      border-radius: 5px;\\n      margin-bottom: 15px;\\n    }\"]\n  });\n  return AddProductComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}